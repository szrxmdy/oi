## 数论
### 取整
取模 : $x \% y = x - \lfloor x / y \rfloor y$

分块 : 

### 裴蜀定理(贝祖)
$$gcd(a,b) | ax + by$$
将右侧同时除以$gcd(a,b)$还是整数,易证
该定理对于更多项数依然成立
[【模板】裴蜀定理](https://www.luogu.com.cn/problem/P4549)

#### gcd
##### 辗转相除
$$
gcd(x,y) = d,x = da,y = db\\
gcd(x,y) = gcd(y,x \% y)
$$
证明:
$$
b = x \% y = x - ky\\
\because b/d = a - kb \\
\therefore d | x \%y\\
即d|a,d|b \rightarrow d|a\% b,\\
同理d|a\% b,d|b \rightarrow d|a,\\
\therefore (a,b)和(a\%b,b)的因数集相同\\
\therefore gcd(a,b) = gcd(b,a\%b)
$$
##### 辗转相减
gcd(x,y) = gcd(y,x - y)
证明同上,即$(a,b)$和$(b,a - kb)$的因数集是相同的

##### 一些理解
无论是哪种求法,其实都是对于裴蜀定理的应用,

##### exgcd
解方程 $n = x a + y b$
有贝祖定理,显然$gcd(a,b) | n$时才有解
当$b = 0时,x = n / a , y = 0$,所以可以用gcd来求解
$$gcd(a,b) = gcd(b,a \%b) \\
n = x'a + y'b = xb + y(a\%b) \\
= xb + ay - \lfloor a / b \rfloor by\\
= ya + (x - \lfloor a/b \rfloor y)b\\
\therefore x ' = y , y ' = x - \lfloor a/b\rfloor y$$

经过递归,我们可以找到一组解,然后怎么找出其他解?
$$n = xa + yb = (x + k_1)a + (y + k_2)b ,k_1,k_2 \neq 0\\
k_1a = - k_2b \\
lcm(a,b) | k_1a,k_2b$$
即让 $x += k(b/gcd(a,b)),k\in \Z$都是可行解
```cpp
void exgcd(int a,int b,int &x,int &y,const int &n) {
    if(b == 0) {x = n / a; y = 0; return ;}
    int x1,y1;
    exgcd(b,a%b,x1,y1,n);
    x = y1; y = x1 - a / b * y1;
}
```
[【模板】二元一次不定方程 (exgcd)](https://www.luogu.com.cn/problem/P5656)

### 逆元
$x x ^-1 = 1 \mod p$
#### exgcd
#### 费马定理
之前一直没有很好的证明费马小定理的方法,现在补坑:
$a^{p-1} = 1 (\mod p)$
证明:
a,2a,3a,4a,(p-1)a....余数互不相同且对应1,2,3....,p-1      定理1
不妨假设 xa = ya (%p)
xa-ya = kp,因为a不是p的倍数,所以x-y为p的倍数,但1~(p-1)肯定不到p,所以定理1成立
定理一左右两边每个数相乘,所得结果肯定相同
即 $1*2*3*..*(p-1)*a^{p-1} = 1*2*3*..*(p-1) (\mod p)$
综上, a^(p-1)=1 (%p)

推广以上证明过程,可得欧拉定理
a^phi[p]=1 (%p) 其中a,p互质

#### 线性求解
我们希望x的逆元能通过一个比x小的数来求得,
这样才可以保证递归下去有解,同时这个数与p和x都有关
所以我们用取模,即$p\%x < x$
$$p = kx + b\\
kx + b = 0\\
k + b * x^{-1} = 0\\
x^-1 = -k * b^{-1} = (p - k) * b^{-1}$$
$inv[1] = 1$
显然会递归越来越小

#### 阶乘
$$x! (x + 1)= (x+1)!\\
x!(x + 1) * (x + 1)!^{-1} = 1\\
\therefore x!^{-1} =  (x + 1) * (x + 1)!^{-1}$$

#### 任意数