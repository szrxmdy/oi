## FFT
从初三就听过了,但一直没学,每次学着学着就开始发呆,浪费了大量时间,此处给出整理

对于一个多项式而言,点值表示法易于加减乘除,
而系数表示法虽然有很大应用,但直接乘是$n^2$的,
所以要将系数表示法转换为点值表示法来乘法,然后转换回去

#### 复数根的性质
用$w_n^k表示x^n的第k个解,log_2 n \in \Z$,令$m = n/2$
- $(w_n^k)^2 = w_m^k$
- $w_n^{m + k} = -w_n^k$
- $(w_n^k)^i = w_n^{ki}$

#### 转换为点值
以下公式i都从0开始
$$A(x) = \sum_i^{n-1}a_ix^i = \sum_i^{m-1}a_{2i}x^{2i} + x\sum_i^{m-1}a_{2i + 1}x^{2i}\\
=A_0(x^2) + xA_1(x^2)$$
$$k < m,A(w_n^k) = A_0(w_m^k) + w_n^kA_1(w_m^k)\\
k > m,A(w_n^{m+k}) = A_0(w_m^k) - w_n^kA_1(w_m^k)
$$

这样可以把$T(n) = 4T(n/2) + n \rightarrow 2T(n/2) + n$
#### 从点值转换为系数
写成矩阵显然可以做到

## ntt
注意到 fft 关键是构造出一些 $w_n^k$ 满足性质 :
- $(w_n^k)^i = w_n^{ki}$
- $(w_{ni}^{ki}) = w_n^k $
- $w_{n}^m = -w_n^0 = -1$

我们可以使用原根来做,记$w_n^k = g^{\frac{P - 1}{n}k} $
前两个显然满足,考虑最后一个 
原根为 $g^i$ 互不相同的 g, $w_n^m = g^{\frac{P - 1}{2}}$,因为$g^{P - 1} = 1$,而两者不同,故$g^{\frac{P - 1}{2}} = -1$

将原式中的 w 换成原根即可,注意模数要选取一个 2 的幂次 + 1,
eg : $998244353 = 2^{23} \times 7 \times 17 + 1 $

原根求解 : 
